<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>../ADC-citation-project - Loader Table Workflow</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../site_libs/datatables-binding-0.28/datatables.js"></script>
<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="../site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="../site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="../site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="../site_libs/selectize-0.12.0/selectize.min.js"></script>
<link href="../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Loader Table Workflow</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>This quarto document describes processing and quality assurance steps used to convert CDFW data into the format needed for ingest into vegbank. Each loader table has a function in the family <code>[table]_loader</code> which is run on input data and generates output files at the desired location. Messages from the loader functions indicate potential issues with input datasets.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>in_dir <span class="ot">&lt;-</span> <span class="st">'/var/data/curation/vegbank/'</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>out_dir <span class="ot">&lt;-</span> <span class="st">'data/loader-tables'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="projects" class="level2">
<h2 class="anchored" data-anchor-id="projects">Projects</h2>
<p>Project loader table data is extracted from <code>RAProjects</code> files.</p>
<p>The project start and stop dates are converted from date-time formats to date formats (dropping the time). Date values are checked to ensure they are reasonable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">project_loader</span>(in_dir, out_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Processing 3 people/contributor tables from:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>•
/var/data/curation/vegbank//VegBankProject_NonStandardDatasets_Submission3_20260121/RAProjects.csv</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>•
/var/data/curation/vegbank//VegBankProject_StdDatasets1_RAReleve_20250915/RAProjects.csv</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>•
/var/data/curation/vegbank//VegBankProject_StdDatasets2_AARecon_20251204/RAProjects.csv</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Writing output to: data/loader-tables/projectLT.csv</code></pre>
</div>
</div>
</section>
<section id="party-and-contributor" class="level2">
<h2 class="anchored" data-anchor-id="party-and-contributor">Party and Contributor</h2>
<p>The two loader tables for Party and Contributor are both extracted from <code>RAProjects</code> files.</p>
<p>The source data is normalized, moving from wide to long format so that each individual in <code>DataContact*{n}</code> columns is in their own row. Emails are checked to ensure they appear valid. Names are then split using whitespace into <code>given_name</code>, <code>middle_name</code>, and <code>sur_name</code>. Unique party codes are generated for each individual (<code>user_py_code</code>). Additionally, all unique individuals already in vegbank are retrieved, along with their project codes. Individuals in the source data are matched to existing vegbank parties, and if any are found the existing vegbank identifier is assigned to <code>vb_py_code</code>.</p>
<p><code>role</code> (a vegbank code starting with <code>ar.</code>) is derived from the <code>DataContactRole{n}</code> columns, which are free text. These values are standardized and mapped to VegBank role codes using a lookup table. The full mapping used in this process is shown below for transparency and review. If no role is found in the source data, the code ar.46 is assigned. The contributor_type field is given a value of “Project” for all rows.</p>
<div class="cell">
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-3d1cb58ff3b070510ceb" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3d1cb58ff3b070510ceb">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["an author of classification report","an author of the vegetation classification","an author on the report, managed the accuracy assessment fieldwork","author of dataset","collected and analyzed data for masters thesis","first author on the vegetation classification","lead author of dataset","lead author on classification report","oversaw fieldwork, lead author","vegetation classification and co-author","classification","classification lead for the project.","classifier","classifier and writer of descriptions","contractor, surveyor, and classification lead","ecologist, completed field sampling and classification","gis analyst and lead photointerpreter","senior biologist during the time of the project. cdfw performed ras and releves, and classified them","vegcamp program lead, project photointerpreter","co-pi, and botany authority","consultant","senior biological consultant","data contact, environmental scientist","prinicpal contact for aecom","project contact","data coordinator","data management","data manager","data processor","data steward, gis specialist","analyzed the plots for the project. was the contractor's project lead","gic used these surveys and classification of them to map the area.","gis analyst","obtained data for cnps","receiver of data","biological science technician (botany)","collector of majority of deer creek hills data","cooperator, and field lead","field coordinator and data collector","field lead","field lead and data entry person","field manager for cnps at the time of rapid assessments","field manager for nps during accuracy assessment","field staff and mapper","lead biologist interpreter","nps lead and data collector","obtained data","primary surveyor","provided student workers","regional biologist who helped with field effort","surveyor","funding agency, land access, private land contacts","california native plant program","planning",null,"one of the principal investigators on the project","primary mapper and one of the principal investigators on the project","principal investigator","principal investigator/author","senior scientist","vegetation program lead and primary investigator","associate vegetation ecologist","associate wildlife biologist, land program - north, eastern sierra - inland deserts region","environmental scientist / vegetation ecologist","environmental scientist/ vegetation ecologist","environmental scientist/vegetation ecologist","lead biologist for vegcamp","lead ecologist","plot author","primary data collector","project ecologist","project ecologist, trainer, cnps vegetation lead","restoration ecologist","vegcamp lead","vegcamp lead biologist","vegetation ecologist","vegetation ecologist; data collection, supervision of vegetation mapping","advisor","previously botanist at deva, now with usfs in bishop, ca","regional biologist who met with us on reviving project","research advisor","senior biologist","senior environmental scientist","sfan i &amp; m natural resource specialist","cnps vegetation program","collected additional data for the project and managed data entry for their surveys","field survey coordinator, and project lead for cnps (now works for cdfw)","funder","land resources manager","managed field crew and database entry for the project","program director","program lead","project lead","project management","project manager","project manager, including mainting sub-contract with prunske-chattam for surveying","project steward","regional lead","vegetation program director","vegetation program lead","vegetation program lead for cnps","wildland vegetation program manager"],["Author","Author","Author","Author","Author","Author","Author","Author","Author","Author","Classifier","Classifier","Classifier","Classifier","Classifier","Classifier","Classifier","Classifier","Classifier","Co-PI","Consultant","Consultant","Contact","Contact","Contact","Data Manager","Data Manager","Data Manager","Data Manager","Data Manager","Data aggregator","Data aggregator","Data aggregator","Data aggregator","Data aggregator","Field assistant","Field assistant","Field assistant","Field assistant","Field assistant","Field assistant","Field assistant","Field assistant","Field assistant","Field assistant","Field assistant","Field assistant","Field assistant","Field assistant","Field assistant","Field assistant","Land owner","Not specified","Not specified","Not specified/Unknown","PI","PI","PI","PI","PI","PI","Plot author","Plot author","Plot author","Plot author","Plot author","Plot author","Plot author","Plot author","Plot author","Plot author","Plot author","Plot author","Plot author","Plot author","Plot author","Plot author","Research advisor","Research advisor","Research advisor","Research advisor","Research advisor","Research advisor","Research advisor","System manager","System manager","System manager","System manager","System manager","System manager","System manager","System manager","System manager","System manager","System manager","System manager","System manager","System manager","System manager","System manager","System manager","System manager"],["ar.16","ar.16","ar.16","ar.16","ar.16","ar.16","ar.16","ar.16","ar.16","ar.16","ar.34","ar.34","ar.34","ar.34","ar.34","ar.34","ar.34","ar.34","ar.34","ar.38","ar.40","ar.40","ar.17","ar.17","ar.17","ar.19","ar.19","ar.19","ar.19","ar.19","ar.56","ar.56","ar.56","ar.56","ar.56","ar.43","ar.43","ar.43","ar.43","ar.43","ar.43","ar.43","ar.43","ar.43","ar.43","ar.43","ar.43","ar.43","ar.43","ar.43","ar.43","ar.45","ar.46","ar.46","ar.47","ar.18","ar.18","ar.18","ar.18","ar.18","ar.18","ar.36","ar.36","ar.36","ar.36","ar.36","ar.36","ar.36","ar.36","ar.36","ar.36","ar.36","ar.36","ar.36","ar.36","ar.36","ar.36","ar.53","ar.53","ar.53","ar.53","ar.53","ar.53","ar.53","ar.54","ar.54","ar.54","ar.54","ar.54","ar.54","ar.54","ar.54","ar.54","ar.54","ar.54","ar.54","ar.54","ar.54","ar.54","ar.54","ar.54","ar.54"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>ContactRole<\/th>\n      <th>role_name<\/th>\n      <th>ar_code<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":25,"autoWidth":true,"scrollX":true,"columnDefs":[],"order":[],"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">party_contributor_loader</span>(in_dir, out_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Processing 3 people/contributor tables from:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>•
/var/data/curation/vegbank//VegBankProject_NonStandardDatasets_Submission3_20260121/RAProjects.csv</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>•
/var/data/curation/vegbank//VegBankProject_StdDatasets1_RAReleve_20250915/RAProjects.csv</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>•
/var/data/curation/vegbank//VegBankProject_StdDatasets2_AARecon_20251204/RAProjects.csv</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! Some email addresses appear to be invalid: retired, not found in NPS directory</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Writing two output files to:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• data/loader-tables/partyLT.csv</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• data/loader-tables/contributorLT.csv</code></pre>
</div>
</div>
</section>
<section id="disturbance" class="level2">
<h2 class="anchored" data-anchor-id="disturbance">Disturbance</h2>
<section id="data-sources-and-merging" class="level3">
<h3 class="anchored" data-anchor-id="data-sources-and-merging">Data Sources and Merging</h3>
<p>Disturbance data is extracted from <code>RAImpacts.csv</code> files, as well as the <code>LImpacts.csv</code> lookup table, which provides descriptive labels for impact codes.</p>
</section>
<section id="intensity-disturbance-values" class="level3">
<h3 class="anchored" data-anchor-id="intensity-disturbance-values">Intensity Disturbance Values</h3>
<p>Intensity values are checked to ensure they conform to expected values (1, 2, or 3). Valid intensity codes are converted to descriptive labels: 1 becomes “Low”, 2 becomes “Moderate”, and 3 becomes “High”. Any non-standard intensity values are left as <code>NA</code>. Unknown values in the <code>CodeImpact</code> field not present in the impacts lookup table are identified. Impact codes present in the <code>CodeImpact</code> field but missing from the impacts lookup table are identified. These values are converted to <code>NA</code> in the <code>disturbance_type</code> field.</p>
<p>Disturbance age and extent are not present in the CDFW data. They are set to <code>NA</code> for all rows in the loader table.</p>
</section>
<section id="final-loader-table" class="level3">
<h3 class="anchored" data-anchor-id="final-loader-table">Final Loader Table</h3>
<p>The lookup table maps (<code>disturbanceLT.csv</code>) specific impact types from CDFW data to standardized VegBank disturbance categories. Detailed impact descriptions (i.e., “Development”, “ORV activity”, “Grazing”, etc.) are converted into broader, standardized categories (i.e., “Human, general”, “Roads and vehicular traffic”, etc.) The full mapping used in this process is shown below for transparency and review.</p>
<div class="cell">
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-088207c424001b59b379" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-088207c424001b59b379">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["Development","ORV activity","Agriculture","Grazing","Competition from exotics","Logging","Insufficient population/stand size","Altered flood/tidal regime","Mining","Hybridization","Groundwater pumping","Dam/inundation","Other","Surface water diversion","Road/trail construction/maint.","Biocides","Pollution","Unknown","Vandalism/dumping/litter","Foot traffic/trampling","Improper burning regime","Over collecting/poaching","Erosion/runoff","Altered thermal regime","Landfill","Degrading water quality","Wood cutting","Military operations","Recreational use (non ORV)","Nest parasitism","Non-native predators","Rip-rap, bank protection","Channelization (human caused)","Feral pigs","Burros","Rills","Phytogenic mounding","Sudden Oak Death (SODS)",null],["Human, general","Roads and vehicular traffic","Cultivation","Grazing, domestic stock","Other disturbances","Timber harvest, general","Other disturbances","Hydrologic alteration","Human, general","Other disturbances","Hydrologic alteration","Hydrologic alteration","Other disturbances","Hydrologic alteration","Roads and vehicular traffic","Herbicide or chemical","Human, general","unknown","Human, general","Trampling and trails","Fire suppression","Human, general","Erosion","Other disturbances","Human, general","Hydrologic alteration","Timber harvest, selective","Human, general","Trampling and trails","Natural, general","Other disturbances","Hydrologic alteration","Hydrologic alteration","Animal, general","Animal, general","Erosion","Erosion","Plant disease","Unknown"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>CDFW Impact Type<\/th>\n      <th>vegbank_disturbance<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":25,"autoWidth":true,"scrollX":true,"columnDefs":[],"order":[],"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="plots" class="level2">
<h2 class="anchored" data-anchor-id="plots">Plots</h2>
<section id="data-sources-and-initial-merging" class="level3">
<h3 class="anchored" data-anchor-id="data-sources-and-initial-merging">Data Sources and Initial Merging</h3>
<p>Plot data is extracted from multiple CSV files, including <code>RAPlots.csv</code>, <code>AltPlots.csv</code>, and <code>AltStrata.csv</code>. These files are all merged into a single table using <code>SurveyID</code> as the join key. Empty columns are removed.</p>
<p>Survey dates are converted to Date format, and validation checks ensure dates fall between 1900 and the present day.</p>
</section>
<section id="coordinate-standardization-and-location-assignment" class="level3">
<h3 class="anchored" data-anchor-id="coordinate-standardization-and-location-assignment">Coordinate Standardization and Location Assignment</h3>
<p>GPS datum values are standardized. EPSG codes are assigned based on the combination of datum and UTM zone. UTM coordinates are converted to latitude/longitude using the appropriate coordinate reference system (CRS) for each plot.</p>
<p>State and county assignments are determined by spatially joining plot coordinates with US state and county boundaries from the TIGRIS package. Plots with missing location information trigger warning messages, and manual corrections are applied for specific known locations.</p>
<p>Here are the CRS Assignment Rules:</p>
<div class="cell">
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-aff07917bb87e4d528d0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-aff07917bb87e4d528d0">{"x":{"filter":"none","vertical":false,"data":[["WGS84","WGS84","NAD83","NAD83","NAD27","NAD27"],[10,11,10,11,10,11],[32610,32611,26910,26911,26710,26711]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>author_datum<\/th>\n      <th>UTM_zone<\/th>\n      <th>epsg<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"autoWidth":true,"scrollX":true,"columnDefs":[{"className":"dt-center","targets":"_all"}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="elevation-and-location-accuracy" class="level3">
<h3 class="anchored" data-anchor-id="elevation-and-location-accuracy">Elevation and Location Accuracy</h3>
<p>Elevation values are converted to <strong>meters</strong> when marked as feet in the source data. GPS error measurements are similarly converted to meters.</p>
</section>
<section id="plot-area-and-shape" class="level3">
<h3 class="anchored" data-anchor-id="plot-area-and-shape">Plot Area and Shape</h3>
<p>Plot area is normalized by removing unit indicators (assuming square meters), converting hectares to square meters, and calculating area from plot dimensions or view radius when direct area measurements are unavailable. A value of <strong><code>-1</code></strong> indicates plots with no defined boundaries.</p>
<p>Plot shapes (circle, square, rectangle) are inferred from available dimension data when not explicitly recorded.</p>
</section>
<section id="slope-and-aspect" class="level3">
<h3 class="anchored" data-anchor-id="slope-and-aspect">Slope and Aspect</h3>
<p>Slope aspect values are standardized, with flat locations coded as <strong><code>-1</code></strong> and variable locations as <strong><code>-2</code></strong>. Slope gradient is calculated from actual measurements when available. Otherwise, it is derived from slope category ranges using midpoint calculations.</p>
</section>
<section id="substrate-cover-rock-and-gravel" class="level3">
<h3 class="anchored" data-anchor-id="substrate-cover-rock-and-gravel">Substrate Cover (Rock and Gravel)</h3>
<p>Rock and gravel cover is computed by summing percent cover values from the <code>Boulders</code>, <code>Stones</code>, <code>Cobbles</code>, and <code>Gravels</code> fields after treating <code>999</code> as missing. Values above 100 trigger warning messages.</p>
<div class="cell">
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0f0d2341dac3736b38f2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0f0d2341dac3736b38f2">{"x":{"filter":"none","vertical":false,"data":[["Boulders, Stones, Cobbles, Gravels"],["999 → NA"],["percentRockGravel"],["row sum of the four fields (na.rm=TRUE); warn if &gt;100"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>source_fields<\/th>\n      <th>missing_rule<\/th>\n      <th>derived_field<\/th>\n      <th>derivation<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"autoWidth":true,"scrollX":true,"columnDefs":[],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="vegetation-height-classes" class="level3">
<h3 class="anchored" data-anchor-id="vegetation-height-classes">Vegetation Height Classes</h3>
<p>Height class fields for conifer, hardwood, shrub, and herbaceous vegetation are converted to numeric values by taking midpoints of ranges (e.g., <code>2–5 m → 3.5</code>). Less-than ranges (e.g., <code>&lt;0.5 m</code>) are converted using a midpoint assumption (half of the threshold value), and “Not recorded” / “Not present” are treated as missing. Values that cannot be parsed trigger warning messages.</p>
<p>This doesn’t hardcode every possible value, it just shows representative examples of the transformation rules.</p>
<div class="cell">
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-16b0414a0edd024005dc" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-16b0414a0edd024005dc">{"x":{"filter":"none","vertical":false,"data":[["2-5 m","0.5-1 m","&lt;0.5 m","&gt;50 m","Not recorded","Not present"],["midpoint of range","midpoint of range","less-than midpoint rule (half)","greater-than rule (keep value or placeholder)","missing token → NA","missing token → NA"],[3.5,0.75,0.25,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>example_input<\/th>\n      <th>rule<\/th>\n      <th>numeric_output<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"autoWidth":true,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="tree-growth-form-assignment" class="level3">
<h3 class="anchored" data-anchor-id="tree-growth-form-assignment">Tree Growth Form Assignment</h3>
<p>Growth form assignments prioritize the dominant tree type (conifer vs.&nbsp;hardwood) based on cover values, with the secondary growth form assigned to the less dominant type.</p>
</section>
<section id="topographic-position" class="level3">
<h3 class="anchored" data-anchor-id="topographic-position">Topographic Position</h3>
<p>Topographic position values from the MacroTopo field are mapped to VegBank’s topo_position values using the lookup table below.</p>
<div class="cell">
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-1877b52f03efc443a964" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1877b52f03efc443a964">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["Bottom","Lower 1/3 of slope","Bottom to Lower 1/3 of slope","Bottom to Mid 1/3 of slope","Bottom to Upper 1/3 of slope","Entire slope","Middle 1/3 of slope","Middle to Upper 1/3 of slope","Lower to Middle 1/3 of slope","Lower to Upper 1/3 of slope","Upper 1/3 of slope","Upper 1/3 of slope to Ridgetop","Middle 1/3 of slope to Ridgetop","Lower 1/3 of slope to Ridgetop","Ridge top","upper","mid","Bench","Channel bed","Lowslope","6","Not recorded","&lt;Null&gt;","Lower 1/3 of slope to Ridegetop","Other","Wash (channel bed)","Toeslope","Terrace (former shoreline or floodplain)","Ridge Top","Dune/sandfield","Draw","Pediment","Unknown","Edge of basin/wetland","* choose one *","Badland (complex of draws &amp; interfluves)","High slope","Midslope","Low level","Step in slope","Toe-slope","Saddle/Summit/Ridgeline","Mid-slope","Braided/flood plain","Rolling Hills/Ridges","Broad wash","Bar/swale","Bajada","Pavements","Valley","Playa","Narrow wash","Deeply dissected hills","Mud hills/Badlands","Entire Slope","Basin/Wetland","Eroded Hills","Flat","Toeslope (alluvial fan/bajada)","High level/summit to HighSlope","Basin/wetland","Low- to midslope","High level/summit","Lower","Mid","Upper","Top","High level","Basin floor","Channel wall","Interfluve/Summit","bottom"],["Basin floor","Lowslope","Lowslope","Lowslope","Midslope","Midslope","Midslope","Midslope","Midslope","Midslope","High slope","High slope","High slope","Midslope","Interfluve","High slope","Midslope","Step in slope","Channel bed","Lowslope","Basin floor",null,null,"Midslope",null,"Channel bed","Toeslope","Low level","Interfluve","Low level","Channel bed","Lowslope",null,"Basin floor",null,"Midslope","High slope","Midslope","Low level","Step in slope","Toeslope","Interfluve","Midslope","Low level","Interfluve","Channel bed","Low level","Toeslope","High level","Low level","Basin floor","Channel bed","Midslope","Midslope","Midslope","Basin floor","Midslope","Low level","Toeslope","High slope","Basin floor","Midslope","High level","Lowslope","Midslope","High slope","Interfluve","High level","Basin floor","Channel wall","Interfluve","Low level"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>MacroTopo<\/th>\n      <th>topo_position<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":25,"autoWidth":true,"scrollX":true,"columnDefs":[],"order":[],"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="loader-table-field-mapping" class="level3">
<h3 class="anchored" data-anchor-id="loader-table-field-mapping">Loader Table Field Mapping</h3>
<p>The table below shows how processed plot fields are mapped into the VegBank PlotObservations loader table.</p>
<div class="cell">
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d19288d8b3c0586b4b3d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d19288d8b3c0586b4b3d">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["user_ob_code","user_pl_code","author_plot_code","latitude","longitude","location_accuracy","confidentiality_status","author_e","author_n","author_zone","author_datum","author_location","azimuth","shape","area","stand_size","elevation","slope_aspect","slope_gradient","topo_position","rock_type","user_pj_code","obs_start_date","method_narrative","tree_ht","shrub_ht","field_ht","tree_cover","shrub_cover","field_cover","growthform_1_type","growthform_2_type","growthform_1_cover","growthform_2_cover"],["SurveyID","Stand_ID","Stand_ID","real_latitude","real_longitude","ErrorMeasurement","ConfidentialityStatus","UTME_final","UTMN_final","UTM_zone","author_datum","SiteLocation","W_Axis_Bearing","PlotShape","PlotArea","Stand_Size","Elevation","Aspect_actual","slope","topo_position","Substrate","ProjectCode","SurveyDate","methodNarrative","treeHt","Shrub_ht22","Herb_ht22","treeCover","Shrub_cover","Herb_cover","growthform1Type","growthform2Type","growthform1Cover","growthform2Cover"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>loader_field<\/th>\n      <th>source_field<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":25,"autoWidth":true,"scrollX":true,"columnDefs":[],"order":[],"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="soils" class="level2">
<h2 class="anchored" data-anchor-id="soils">Soils</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">soil_loader</span>(in_dir, out_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Processing 3 soil tables from:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>•
/var/data/curation/vegbank//VegBankProject_NonStandardDatasets_Submission3_20260121/RAPlots.csv</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>•
/var/data/curation/vegbank//VegBankProject_StdDatasets1_RAReleve_20250915/RAPlots.csv</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>•
/var/data/curation/vegbank//VegBankProject_StdDatasets2_AARecon_20251204/RAPlots.csv</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One or more parsing issues, call `problems()` on your data frame for details,
e.g.:
  dat &lt;- vroom(...)
  problems(dat)
One or more parsing issues, call `problems()` on your data frame for details,
e.g.:
  dat &lt;- vroom(...)
  problems(dat)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Writing output file to:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• data/loader-tables/soilLT.csv</code></pre>
</div>
</div>
</section>
<section id="community" class="level2">
<h2 class="anchored" data-anchor-id="community">Community</h2>
<section id="data-sources-and-merging-1" class="level3">
<h3 class="anchored" data-anchor-id="data-sources-and-merging-1">Data Sources and Merging</h3>
<p>Community classification data is extracted from <code>RAClassifications.csv</code> files, along with <code>RAPlots.csv</code> and <code>RAProjects.csv</code> files. These files are all merged into a single table using <code>ProjectCode</code> as the join key. Empty columns are removed.</p>
</section>
<section id="standardized-classification-methods" class="level3">
<h3 class="anchored" data-anchor-id="standardized-classification-methods">Standardized Classification Methods</h3>
<p>Classification methods are standardized using a lookup table that maps project codes to classification techniques. Three classification approaches are identified from project metadata: inspection-based classification, multi-variate analysis, and table analysis. Classification descriptions and tools from project records are concatenated into a <code>class_notes</code> field, with empty or redundant entries cleaned.</p>
</section>
<section id="class-confidence" class="level3">
<h3 class="anchored" data-anchor-id="class-confidence">Class Confidence</h3>
<p>Confidence values from the <code>Confidence_ID</code> field are normalized to three categories: “High”, “Medium” and “Low”. The function handles multiple input formats including single letters (H, M, L), full words (High, Medium, Low), and percentage values. Percentages of 75% or greater are mapped to “High”, while values below 75% are mapped to “Medium”. Missing value indicators are converted to NA. Any unparse-able or unexpected confidence values trigger warnings. The confidence identifiers and percentages are mapped below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>class_confidence <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span><span class="st">`</span><span class="at">Confidence Letter</span><span class="st">`</span>, <span class="sc">~</span><span class="st">`</span><span class="at">Confidence Class</span><span class="st">`</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"H"</span>, <span class="st">"High"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"M"</span>, <span class="st">"Medium"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"L"</span>, <span class="st">"Low"</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  class_confidence,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">"top"</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">25</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>, <span class="at">scrollX =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-fcc8cbb38c78031895f4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-fcc8cbb38c78031895f4">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["H","M","L"],["High","Medium","Low"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Confidence Letter<\/th>\n      <th>Confidence Class<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":25,"autoWidth":true,"scrollX":true,"columnDefs":[],"order":[],"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>percentage_confidence <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span><span class="st">`</span><span class="at">Confidence Percentage</span><span class="st">`</span>, <span class="sc">~</span><span class="st">`</span><span class="at">Confidence Class</span><span class="st">`</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"&gt;= 75%"</span>, <span class="st">"High"</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"&lt; 75%"</span>, <span class="st">"Medium"</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  percentage_confidence,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">"top"</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">25</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>, <span class="at">scrollX =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f91132c5b45eda880fec" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f91132c5b45eda880fec">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["&gt;= 75%","&lt; 75%"],["High","Medium"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Confidence Percentage<\/th>\n      <th>Confidence Class<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":25,"autoWidth":true,"scrollX":true,"columnDefs":[],"order":[],"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="community-concept-matching" class="level3">
<h3 class="anchored" data-anchor-id="community-concept-matching">Community Concept Matching</h3>
<p>Community concepts are downloaded from the VegBank API and cached locally. Only currently accepted concepts are used for matching. California vegetation codes (<code>CaCode</code>) from the CDFW data are matched to NVC (National Vegetation Classification) codes using a crosswalk table (<code>VegBank_CrosswalkHierarchyMCV.csv</code>). NVC codes are then matched to VegBank community concept codes (<code>cc_code</code>). For CaCodes that map to multiple NVC codes, only the first mapping is used to prevent row duplication, although a warning is issued. Records without successful matches (no corresponding VegBank community concept) are flagged and exported to a separate file (<code>cacode-nolookup.csv</code>) for review. The total count of unmatched records is reported via warning message. Attached below is the matching process workflow.</p>
<ol type="1">
<li>Normalize <code>CaCode</code> values (lowercase, trim whitespace)</li>
<li>Map <code>CaCode</code> -&gt; NVC code (via crosswalk table)</li>
<li>Map NVC Code -&gt; VegBank community concept code (via VegBank API data)</li>
</ol>
<p>Additionally, each community concept in VegBank requires two names to be fully documented: a scientific name and a code. This dual naming system ensures communities can be referenced.</p>
<p>The <code>CommunityNames</code> table has two rows for each single plant present in the <code>CommunityConcepts</code> table. Between the two rows, the variables <code>user_cc_code</code>, <code>name_type</code>, and <code>name</code> will differ based on whether the row represents the scientific name or the code name.</p>
<p>Here is a table that shows an example of what the data would look like within <code>CommunityNames</code>, based on one example entry.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CommunityNames Table</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Community Loader</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">community_loader</span>(in_dir, out_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>! cacode_map has duplicate CaCode values (45 codes). Mapping may be ambiguous.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sample duplicates:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- 21.310.00- 32.037.00- 33.020.00- 35.110.00- 35.111.00- 35.150.00- 35.310.00-
36.310.00- 36.400.00- 37.070.00</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! Some CaCode values map to multiple NVC codes in cacode_map (45 CaCodes). Using the first NVC code for now to avoid row duplication.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- 21.310.00- 32.037.00- 33.020.00- 35.110.00- 35.111.00- 35.150.00- 35.310.00-
36.310.00- 36.400.00- 37.070.00</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! vb_cc_code is NA for 14279 rows (out of 30468).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Writing output file to:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• data/loader-tables/communityClassificationsLT.csv</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Reference Table</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>refs <span class="ot">&lt;-</span> <span class="fu">load_reference_tables</span>(in_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>! cacode_map has duplicate CaCode values (45 codes). Mapping may be ambiguous.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sample duplicates:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- 21.310.00- 32.037.00- 33.020.00- 35.110.00- 35.111.00- 35.150.00- 35.310.00-
36.310.00- 36.400.00- 37.070.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract cacode_map from Reference Table</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>cacode_map <span class="ot">&lt;-</span> refs<span class="sc">$</span>cacode_map</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find duplicate cacode</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>dup <span class="ot">&lt;-</span> cacode_map <span class="sc">%&gt;%</span> </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(CaCode_norm) <span class="sc">%&gt;%</span> </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>duplicate_mappings <span class="ot">&lt;-</span> cacode_map <span class="sc">%&gt;%</span> </span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CaCode_norm <span class="sc">%in%</span> dup<span class="sc">$</span>CaCode_norm) <span class="sc">%&gt;%</span> </span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CaCode, CaCode_norm, <span class="st">`</span><span class="at">2009/NVC_Code</span><span class="st">`</span>, NVC_norm, ScientificName) <span class="sc">%&gt;%</span> </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(CaCode_norm)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display CommunityNames Table</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  duplicate_mappings, </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">"top"</span>,</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">25</span>,</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">autoWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">columnDefs =</span> <span class="fu">list</span>(</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">className =</span> <span class="st">'dt-left'</span>, <span class="at">targets =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)),</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">className =</span> <span class="st">'dt-center'</span>, <span class="at">targets =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-c7628f26d319d316304a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c7628f26d319d316304a">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["21.310.00","21.310.00","32.037.00","32.037.00","33.020.00","33.020.00","35.110.00","35.110.00","35.111.00","35.111.00","35.150.00","35.150.00","35.310.00","35.310.00","36.310.00","36.310.00","36.400.00","36.400.00","36.400.00","37.070.00","37.070.00","37.323.00","37.323.00","38.125.00","38.125.00","41.200.00","41.200.00","41.251.00","41.251.00","41.251.00","42.043.00","42.043.00","45.164.00","45.164.00","45.166.00","45.166.00","45.178.00","45.178.00","45.232.00","45.232.00","45.405.00","45.405.00","52.121.00","52.121.00","52.124.00","52.124.00","52.124.00","52.205.00","52.205.00","61.111.00","61.111.00","61.130.00","61.130.00","61.201.00","61.201.00","61.209.00","61.209.00","61.420.00","61.420.00","61.460.00","61.460.00","61.460.00","61.565.00","61.565.00","61.810.00","61.810.00","63.910.00","63.910.00","71.030.00","71.030.00","74.100.00","74.100.00","74.100.00","76.100.00","76.100.00","81.100.00","81.100.00","81.200.00","81.200.00","83.100.00","83.100.00","83.200.00","83.200.00","83.200.00","84.100.00","84.100.00","84.200.00","84.200.00","84.200.00","87.080.00","87.080.00","87.170.00","87.170.00","87.206.00","87.206.00","88.200.00","88.200.00"],["21.310.00","21.310.00","32.037.00","32.037.00","33.020.00","33.020.00","35.110.00","35.110.00","35.111.00","35.111.00","35.150.00","35.150.00","35.310.00","35.310.00","36.310.00","36.310.00","36.400.00","36.400.00","36.400.00","37.070.00","37.070.00","37.323.00","37.323.00","38.125.00","38.125.00","41.200.00","41.200.00","41.251.00","41.251.00","41.251.00","42.043.00","42.043.00","45.164.00","45.164.00","45.166.00","45.166.00","45.178.00","45.178.00","45.232.00","45.232.00","45.405.00","45.405.00","52.121.00","52.121.00","52.124.00","52.124.00","52.124.00","52.205.00","52.205.00","61.111.00","61.111.00","61.130.00","61.130.00","61.201.00","61.201.00","61.209.00","61.209.00","61.420.00","61.420.00","61.460.00","61.460.00","61.460.00","61.565.00","61.565.00","61.810.00","61.810.00","63.910.00","63.910.00","71.030.00","71.030.00","74.100.00","74.100.00","74.100.00","76.100.00","76.100.00","81.100.00","81.100.00","81.200.00","81.200.00","83.100.00","83.100.00","83.200.00","83.200.00","83.200.00","84.100.00","84.100.00","84.200.00","84.200.00","84.200.00","87.080.00","87.080.00","87.170.00","87.170.00","87.206.00","87.206.00","88.200.00","88.200.00"],["A1614","A0822","A1568","A1107","A3144","A3220","A3198","A3194","A3208","A3207","A2557","A3200","A3196","A3266","A0869","A3266","A2507","A1046","A0834","A3886","A2672","A3859","A3865","A4023","A4101","A1332","A3900","A3899","A3739","A4210","A3872","A3255","A3832","A2514","A3437","A3599","A3435","A3806","A3807","A3891","A3364","A3831","A3804","A3805","A3926","A1747","A3927","A3849","A3255","A3760","A2036","A0644","A3803","A0977","A3878","A0947","A3800","A3777","A0306","A0427","A3753","A3745","A3973","A1033","A3750","A0618","A2609","A0836","A3327","A3328","A3346","A0106","A3750","A0587","A3792","A3606","A0104","A3728","A3727","A3757","A3614","A3608","A3607","A3604","A3620","A3617","A3378","A3379","A3377","A3758","A3621","A3620","A3622","A3673","A3672","A3678","A3619"],["a1614","a0822","a1568","a1107","a3144","a3220","a3198","a3194","a3208","a3207","a2557","a3200","a3196","a3266","a0869","a3266","a2507","a1046","a0834","a3886","a2672","a3859","a3865","a4023","a4101","a1332","a3900","a3899","a3739","a4210","a3872","a3255","a3832","a2514","a3437","a3599","a3435","a3806","a3807","a3891","a3364","a3831","a3804","a3805","a3926","a1747","a3927","a3849","a3255","a3760","a2036","a0644","a3803","a0977","a3878","a0947","a3800","a3777","a0306","a0427","a3753","a3745","a3973","a1033","a3750","a0618","a2609","a0836","a3327","a3328","a3346","a0106","a3750","a0587","a3792","a3606","a0104","a3728","a3727","a3757","a3614","a3608","a3607","a3604","a3620","a3617","a3378","a3379","a3377","a3758","a3621","a3620","a3622","a3673","a3672","a3678","a3619"],["Eriophyllum staechadifolium – Erigeron glaucus – Eriogonum latifolium","Eriophyllum staechadifolium – Erigeron glaucus – Eriogonum latifolium","Eriogonum spp. / Poa secunda","Eriogonum spp. / Poa secunda","Coleogyne ramosissima","Coleogyne ramosissima","Artemisia tridentata","Artemisia tridentata","Artemisia tridentata ssp. vaseyana","Artemisia tridentata ssp. vaseyana","Artemisia cana","Artemisia cana","Ericameria nauseosa","Ericameria nauseosa","Atriplex canescens","Atriplex canescens","Sarcobatus vermiculatus","Sarcobatus vermiculatus","Sarcobatus vermiculatus","Lotus scoparius – Lupinus albifrons – Eriodictyon spp.","Lotus scoparius – Lupinus albifrons – Eriodictyon spp.","Arctostaphylos (canescens, manzanita, stanfordiana)","Arctostaphylos (canescens, manzanita, stanfordiana)","Ericameria linearifolia – Cleome isomeris","Ericameria linearifolia – Cleome isomeris","Distichlis spicata [inactive]","Distichlis spicata [inactive]","Festuca idahoensis – Danthonia californica","Festuca idahoensis – Danthonia californica","Festuca idahoensis – Danthonia californica","Centaurea (virgata)","Centaurea (virgata)","Carex nigricans","Carex nigricans","Carex lasiocarpa","Carex lasiocarpa","Carex limosa [inactive]","Carex limosa [inactive]","Eleocharis (acicularis, macrostachya) [inactive]","Eleocharis (acicularis, macrostachya) [inactive]","Vaccinium cespitosum","Vaccinium cespitosum","Carex (utriculata, vesicaria) [inactive]","Carex (utriculata, vesicaria) [inactive]","Nuphar spp. – Potamogeton spp. – Lemna spp. Freshwater Aquatic [inactive]","Nuphar spp. – Potamogeton spp. – Lemna spp. Freshwater Aquatic [inactive]","Nuphar spp. – Potamogeton spp. – Lemna spp. Freshwater Aquatic [inactive]","Lepidium latifolium – Lactuca serriola","Lepidium latifolium – Lactuca serriola","Populus tremuloides","Populus tremuloides","Populus fremontii – Fraxinus velutina – Salix gooddingii","Populus fremontii – Fraxinus velutina – Salix gooddingii","Salix lasiolepis","Salix lasiolepis","Salix exigua","Salix exigua","Alnus rhombifolia","Alnus rhombifolia","Acer macrophyllum – Alnus rubra [pending]","Acer macrophyllum – Alnus rubra [pending]","Acer macrophyllum – Alnus rubra [pending]","Celtis laevigata var. reticulata – Rhus trilobata","Celtis laevigata var. reticulata – Rhus trilobata","Juglans hindsii and Hybrids","Juglans hindsii and Hybrids","Rubus spectabilis – Morella californica","Rubus spectabilis – Morella californica","Quercus garryana (tree)","Quercus garryana (tree)","Umbellularia californica","Umbellularia californica","Umbellularia californica","Cercocarpus montanus","Cercocarpus montanus","Chamaecyparis lawsoniana","Chamaecyparis lawsoniana","Callitropsis nootkatensis","Callitropsis nootkatensis","Picea engelmannii","Picea engelmannii","Picea sitchensis","Picea sitchensis","Picea sitchensis","Tsuga mertensiana","Tsuga mertensiana","Tsuga heterophylla","Tsuga heterophylla","Tsuga heterophylla","Pinus contorta ssp. murrayana","Pinus contorta ssp. murrayana","Pinus monticola","Pinus monticola","Pinus lambertiana","Pinus lambertiana","Abies magnifica","Abies magnifica"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>CaCode<\/th>\n      <th>CaCode_norm<\/th>\n      <th>2009/NVC_Code<\/th>\n      <th>NVC_norm<\/th>\n      <th>ScientificName<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":25,"autoWidth":true,"columnDefs":[{"className":"dt-left","targets":[0,4]},{"className":"dt-center","targets":[1,2,3]}],"order":[],"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Here is a table that shows an example of what the data would look like within <code>CommunityConcepts</code>, corresponding to the example entry shown from <code>CommunityNames</code>. The first row represents the scientific name, with the following row representing the code name.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Community Concepts Table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="final-loader-table-1" class="level3">
<h3 class="anchored" data-anchor-id="final-loader-table-1">Final Loader Table</h3>
<p>The final loader table (<code>communityClassificationsLT.csv</code>) links each survey observation to its community classification, confidence level, classification methods used, and corresponding VegBank community concept code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">community_loader</span>(in_dir, out_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>! cacode_map has duplicate CaCode values (45 codes). Mapping may be ambiguous.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sample duplicates:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- 21.310.00- 32.037.00- 33.020.00- 35.110.00- 35.111.00- 35.150.00- 35.310.00-
36.310.00- 36.400.00- 37.070.00</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! Some CaCode values map to multiple NVC codes in cacode_map (45 CaCodes). Using the first NVC code for now to avoid row duplication.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- 21.310.00- 32.037.00- 33.020.00- 35.110.00- 35.111.00- 35.150.00- 35.310.00-
36.310.00- 36.400.00- 37.070.00</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! vb_cc_code is NA for 14279 rows (out of 30468).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Writing output file to:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• data/loader-tables/communityClassificationsLT.csv</code></pre>
</div>
</div>
</section>
</section>
<section id="strata-cover-taxonomy" class="level2">
<h2 class="anchored" data-anchor-id="strata-cover-taxonomy">Strata, Cover, Taxonomy</h2>
<section id="data-sources-and-merging-2" class="level3">
<h3 class="anchored" data-anchor-id="data-sources-and-merging-2">Data Sources and Merging</h3>
<p>Plant species data and vegetration strata are extracted from <code>RAPlants.csv</code> files, while project-level stratum methodology descriptions are from <code>RAProjects.csv</code> files. Each unique combination of <code>SurveyID</code> and stratum layer (<code>Stratum</code>) creates a distinct stratum identifier (i.e., <code>ALCC001_Shrub</code>). The data is processed to create two interconnected loader tables: one for strata cover (species abundance by vegetation layer) and one for taxonomic interpretations (linking species names to standardized plant concepts).</p>
</section>
<section id="person-assignment-for-taxonomic-interpretations" class="level3">
<h3 class="anchored" data-anchor-id="person-assignment-for-taxonomic-interpretations">Person Assignment for Taxonomic Interpretations</h3>
<p>Each plant observation requires attribution to a person who made the taxonomic identification. The system prioritizes contributor roles in the following order to determine the most appropriate identifier (along with the associated AR code):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>taxonomic_identifiers <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>ar_code, <span class="sc">~</span>role_name,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.55"</span>, <span class="st">"Taxonomist"</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.34"</span>, <span class="st">"Classifier"</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.18"</span>, <span class="st">"PI"</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.38"</span>, <span class="st">"Co-PI"</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.16"</span>, <span class="st">"Author"</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.51"</span>, <span class="st">"Publication author"</span>,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.36"</span>, <span class="st">"Plot author"</span>,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.53"</span>, <span class="st">"Research advisor"</span>,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.19"</span>, <span class="st">"Data Manager"</span>,</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.50"</span>, <span class="st">"Plot contributor"</span>,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.40"</span>, <span class="st">"Consultant"</span>,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.17"</span>, <span class="st">"Contact"</span>,</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.54"</span>, <span class="st">"System manager"</span>,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.56"</span>, <span class="st">"Data aggregator"</span>,</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.39"</span>, <span class="st">"Computer (automated)"</span>,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.43"</span>, <span class="st">"Field assistant"</span>,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.44"</span>, <span class="st">"Guide"</span>,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.48"</span>, <span class="st">"Passive observer"</span>,</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.45"</span>, <span class="st">"Land owner"</span>,</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.46"</span>, <span class="st">"Not specified"</span>,</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar.47"</span>, <span class="st">"Not specified/Unknown"</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>  taxonomic_identifiers,</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">"top"</span>,</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">25</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>, <span class="at">scrollX =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-999e804878a938ec02ec" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-999e804878a938ec02ec">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["ar.55","ar.34","ar.18","ar.38","ar.16","ar.51","ar.36","ar.53","ar.19","ar.50","ar.40","ar.17","ar.54","ar.56","ar.39","ar.43","ar.44","ar.48","ar.45","ar.46","ar.47"],["Taxonomist","Classifier","PI","Co-PI","Author","Publication author","Plot author","Research advisor","Data Manager","Plot contributor","Consultant","Contact","System manager","Data aggregator","Computer (automated)","Field assistant","Guide","Passive observer","Land owner","Not specified","Not specified/Unknown"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>ar_code<\/th>\n      <th>role_name<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":25,"autoWidth":true,"scrollX":true,"columnDefs":[],"order":[],"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>For each survey observation, the person with the highest-priority role is assigned as the taxon interpreter. This information is derived by joining plot data with contributor data through project codes.</p>
</section>
<section id="plant-concept-matching" class="level3">
<h3 class="anchored" data-anchor-id="plant-concept-matching">Plant Concept Matching</h3>
<p>All plant concepts are downloaded from the VegBank API and cached locally. The matching process prioritizes USDA Plants reference lists, with preference given to the most recent version when a plant code appears in multiple lists.</p>
<p>Plant names and codes from CDFW data are normalized using the following hierarchy:</p>
<ol type="1">
<li>If <code>CurrPlantsSymbol</code> (current USDA Plants symbol) is available, use it.</li>
<li>Otherwise, fall back to <code>CodeSpecies</code> (older plant code).</li>
<li>Similarly, <code>SpeciesName</code> takes precedence over <code>Species_name</code> for scientific names.</li>
</ol>
<p>Normalized USDA plant codes are matched to VegBank plant concept codes (<code>pc_code</code>) through the plant concept database. Records without successful matches (missing <code>pc_code</code>) are flagged via warning messages, as plant concept codes are required for VegBank ingest.</p>
</section>
<section id="strata-identification" class="level3">
<h3 class="anchored" data-anchor-id="strata-identification">Strata Identification</h3>
<p>Each plant observation is assigned a unique stratum identifier by concatenating the survey ID (<code>SurveyID</code>) and stratum layer (<code>Stratum</code>). This links individual plant records to their vertical position in the vegetation structure (tree layer, shrub layer, herb layer, etc.)</p>
</section>
<section id="strata-standardization" class="level3">
<h3 class="anchored" data-anchor-id="strata-standardization">Strata Standardization</h3>
<p>Stratum names are normalized to lowercase and corrected based on project-specific rules to ensure consistency with VegBank stratum methods. The following manual corrections are applied:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>strata_standardization <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span><span class="st">`</span><span class="at">Project Code</span><span class="st">`</span>, <span class="sc">~</span><span class="st">`</span><span class="at">Original Stratum</span><span class="st">`</span>, <span class="sc">~</span><span class="st">`</span><span class="at">Corrected Stratum</span><span class="st">`</span>,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ALCC"</span>, <span class="st">"nv"</span>, <span class="st">"non-vasc"</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ALCC-GR"</span>, <span class="st">"nv"</span>, <span class="st">"non-vasc"</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SCRUZ"</span>, <span class="st">"shrubs"</span>, <span class="st">"shrub"</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SLAV"</span>, <span class="st">"shrubs"</span>, <span class="st">"shrub"</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SLAV"</span>, <span class="st">"shrutb"</span>, <span class="st">"shrub"</span>,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SLAV"</span>, <span class="st">"shsrub"</span>, <span class="st">"shrub"</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  strata_standardization,</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">"top"</span>,</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">25</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>, <span class="at">scrollX =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-563810a1d621f2390c98" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-563810a1d621f2390c98">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["ALCC","ALCC-GR","SCRUZ","SLAV","SLAV","SLAV"],["nv","nv","shrubs","shrubs","shrutb","shsrub"],["non-vasc","non-vasc","shrub","shrub","shrub","shrub"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Project Code<\/th>\n      <th>Original Stratum<\/th>\n      <th>Corrected Stratum<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":25,"autoWidth":true,"scrollX":true,"columnDefs":[],"order":[],"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="final-loader-table-2" class="level3">
<h3 class="anchored" data-anchor-id="final-loader-table-2">Final Loader Table</h3>
<p>Three loader tables are generated:</p>
<ol type="1">
<li><strong>Strata Cover Data</strong> (<code>strataCoverLT.csv</code>) contains species abundance information, including the plant name as recorded by the author and the cover percentage.</li>
<li><strong>Strata Definitions Data</strong> (<code>strataDefinitionsLT.csv</code>) links to the survey observation and stratum definition.</li>
<li><strong>Taxon Interpretations</strong> (<code>taxonInterpretationsLT.csv</code>) links author-recorded plant names to standardized VegBank plant concept codes, includes attribution to the person who made the identification, and marks both <code>original_interpretation</code> and <code>current_interpretation</code> as TRUE since these represent the initial taxonomic determinations.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stratacover_taxon_loader</span>(in_dir, out_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>! 5629 rows have NA values for `user_py_code`. A person and role are required for the taxon interpretations loader table.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! 12114 rows have NA `pc_code` (required for ingest).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sample unmapped USDA codes:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• 2MOSS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• 2BRY</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• SNAG</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• POACEA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ASTERA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• CARYOP</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• HALORA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• POLYGO</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• BRASSI</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• 2FORB</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• APIACE</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ERJE2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• 2JMELGO</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• DYBO</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• SEGR4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Writing two output files to:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• data/loader-tables/strataCoverLT.csv</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• data/loader-tables/taxonInterpretationsLT.csv</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stratadefinitions_loader</span>(in_dir, out_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>! Some proj_code values from plotsLT.csv did not match RAProjects.csv ProjectCode (6 codes).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sample missing proj_code values:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• CPVC</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• EBRP</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• CARR</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• HETH</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• CEQA_WRFB</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• OWVA-Recon</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using https://api-dev.vegbank.org as base URL</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! 3 proj_code values did not map to a VegBank stratum method (sm_code).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sample proj_code with missing sm_code:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• DEVA-DelFavero</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• SAMO</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• SNI</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! 7661 strata rows have NA vb_sy_code (cannot ingest those strata definitions).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sample strata_id with missing vb_sy_code:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA139_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA170_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA174_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA175_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA190_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA203_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA205_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA209_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA229_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA240_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA329_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA388_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA403_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA443_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• ANZA447_NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Writing output file to:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• data/loader-tables/strataDefinitionsLT.csv</code></pre>
</div>
</div>
</section>
</section>
<section id="new-community-concepts" class="level2">
<h2 class="anchored" data-anchor-id="new-community-concepts">New Community Concepts</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">community_definitions_loader</span>(in_dir, out_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>! Some MVC level values were not recognized (comm_level set to NA):</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Special Stands</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! Some rows are missing an Alliance/Association level (11 rows).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Filtered MCV rows: 3202 -&gt; 1623 (kept CaCodes present in RAClassification).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Writing two output files to:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• data/loader-tables/communityConceptsLT.csv</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• data/loader-tables/communityNamesLT.csv</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>